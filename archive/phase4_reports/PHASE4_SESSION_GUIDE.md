# Phase4 セッション継続ガイド

## 🔄 **セッション開始時の手順**

### **1. 必須コンテキスト読み込み (毎回)**
```
@README.md @REFACTORING_STATUS.md @PHASE4_PROGRESS_TRACKER.md
```

### **2. 現在状況の確認**
- `PHASE4_PROGRESS_TRACKER.md` で最後の作業内容を確認
- 未完了タスクと次回作業項目を特定
- 現在のWeek・Day・進捗率を把握

### **3. 作業対象の準備**
```
@src/gui/folder_tree.py @PHASE4_SAFETY_PLAN.md @LARGE_FILES_ANALYSIS.md
```

### **4. 安全性確認**
```
@PHASE4_PREPARATION_CHECKLIST.md @.amazonq/rules/safety.md
```

## 📝 **セッション終了時の手順**

### **1. 進捗更新 (必須)**
`PHASE4_PROGRESS_TRACKER.md` の以下セクションを更新:

#### **現在の進捗状況**
- Week X Day Y の完了状況を更新
- 全体進捗率を更新
- 現在ステータスを更新

#### **作業ログ追加**
```markdown
### **YYYY-MM-DD (セッションX)**
**作業内容**:
- [実施した具体的な作業]
- [完了したタスク]

**成果物**:
- `[作成・変更したファイル名]`
- `[新規作成したファイル名]`

**進捗更新**:
- Week X Day Y: [完了/進行中/未開始]
- 全体進捗: X% (X/7週間)

**次回作業**:
- [次回セッションで最優先で行う作業]
- [継続が必要な作業項目]

**問題・課題**:
- [発見した問題や技術的課題]
- [解決が必要な事項]
```

### **2. 次回作業項目の明確化**
「次回セッション時の最優先作業」セクションを更新:
- 具体的な作業内容
- 必要な時間の見積もり
- 前提条件や準備事項

### **3. 安全性状況の更新**
- 完了した安全対策項目をチェック
- 新たに発見したリスクを記録
- 必要に応じて対策を追加

## 🎯 **Week別セッション継続ポイント**

### **Week 0: 準備週間**
**継続時の確認事項**:
- [ ] 依存関係分析結果の確認
- [ ] folder_tree.py分析の進捗
- [ ] テスト環境構築状況
- [ ] アーキテクチャ設計の完成度

**次回セッション準備**:
- 前回の分析結果を読み込み
- 未完了の準備作業を特定
- 必要なツール・スクリプトの確認

### **Week 1: 非同期処理分離**
**継続時の確認事項**:
- [ ] 非同期処理の理解度
- [ ] 分離対象コンポーネントの特定
- [ ] 新モジュール設計の進捗
- [ ] テスト実装状況

**次回セッション準備**:
- 非同期処理関連コードの確認
- 分離戦略の詳細確認
- 安全性ラッパーの準備状況

### **Week 2-4: 段階的分離**
**継続時の確認事項**:
- [ ] 前週の分離結果の確認
- [ ] 統合テストの実行結果
- [ ] 性能劣化の有無
- [ ] 新たな依存関係の発見

**次回セッション準備**:
- 分離済みコンポーネントの動作確認
- 次の分離対象の準備
- インターフェース設計の確認

### **Week 5-6: 統合・品質保証**
**継続時の確認事項**:
- [ ] 全コンポーネントの統合状況
- [ ] 品質指標の達成度
- [ ] 性能テスト結果
- [ ] ドキュメント完成度

**次回セッション準備**:
- 品質チェックリストの確認
- 最終テスト項目の準備
- 完了判定基準の確認

## 🚨 **中断時の緊急対応**

### **予期しない中断時**
1. **現在の作業状況を記録**
   - 実行中のコマンド・操作
   - 変更したファイル
   - 発見した問題

2. **安全な状態で保存**
   ```bash
   # 変更をコミット
   git add .
   git commit -m "WIP: [作業内容の簡潔な説明]"
   
   # ブランチの確認
   git branch
   ```

3. **次回再開用メモ作成**
   - 中断時点の詳細状況
   - 再開時の注意事項
   - 必要な準備作業

### **長期中断時**
1. **完全な状況記録**
   - 詳細な作業ログ作成
   - 技術的発見事項の記録
   - 変更したファイルの一覧

2. **安全性確認**
   - 現在の状態が安全かチェック
   - 必要に応じてロールバック
   - バックアップの確認

3. **再開計画の調整**
   - 中断期間を考慮した計画修正
   - 技術的知識の再習得時間確保
   - 安全性チェックの強化

## 📊 **進捗可視化**

### **進捗確認コマンド**
```bash
# 現在の行数確認
wc -l src/gui/folder_tree.py

# 新規作成ファイル確認
find src/gui/folder_tree/ -name "*.py" 2>/dev/null | wc -l

# Git状況確認
git status
git log --oneline -5
```

### **品質指標確認**
```bash
# 構文チェック
bash -c "source venv/bin/activate && python -m py_compile src/gui/folder_tree.py"

# 依存関係確認
bash -c "source venv/bin/activate && python scripts/analyze_dependencies.py"
```

## 🔧 **トラブルシューティング**

### **よくある継続時の問題**

#### **1. コンテキスト不足**
**症状**: 前回の作業内容が思い出せない
**対策**: 
- `PHASE4_PROGRESS_TRACKER.md` の作業ログを詳細確認
- 変更されたファイルの差分確認
- コミット履歴の確認

#### **2. 環境の不整合**
**症状**: 前回動作していたコードが動かない
**対策**:
- 仮想環境のアクティベート確認
- 依存関係の再インストール
- ブランチの確認

#### **3. 作業の重複**
**症状**: 同じ作業を繰り返してしまう
**対策**:
- 進捗トラッカーの完了項目確認
- 成果物の存在確認
- 前回セッションの成果確認

### **緊急時連絡先**
- **技術文書**: `PHASE4_SAFETY_PLAN.md`
- **安全ルール**: `.amazonq/rules/safety.md`
- **ロールバック手順**: `PHASE4_PROGRESS_TRACKER.md` の緊急時情報

---
**作成日**: 2025-08-28
**用途**: Phase4セッション継続・中断対応
**重要度**: 🔴 最高 - 作業継続の必須ガイド
**更新**: 作業パターンの変更時に更新必要