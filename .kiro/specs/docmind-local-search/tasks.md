# 実装計画

- [x] 1. プロジェクト構造とコア依存関係の設定









  - モデル、サービス、GUIコンポーネント、データストレージ用のディレクトリ構造を作成
  - 必要なすべての依存関係（PySide6、Whoosh、sentence-transformers、PyMuPDF、python-docx、openpyxl）を含むrequirements.txtを設定
  - メインアプリケーションのエントリーポイントと基本的な設定管理を作成
  - _要件: 7.2, 7.3_

- [x] 2. コアデータモデルと例外の実装







  - 必要なすべてのフィールドと検証を持つDocumentデータクラスを作成
  - スコアリングとスニペット情報を持つSearchResultデータクラスを作成
  - SearchType列挙型とその他のサポートデータ構造を実装
  - エラーハンドリング用のカスタム例外階層を作成
  - _要件: 6.6, 7.6_

- [x] 3. ドキュメント処理システムの実装




  - 各ファイル形式のテキスト抽出メソッドを持つDocumentProcessorクラスを作成
  - エラーハンドリング付きでPyMuPDFを使用したPDFテキスト抽出を実装
  - python-docxを使用したWordドキュメント処理を実装
  - openpyxlを使用したすべてのシートとセルからのExcelテキスト抽出を実装
  - エンコーディング検出付きでMarkdownとテキストファイル処理を実装
  - 各ドキュメントプロセッサーメソッドのユニットテストを作成
  - _要件: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6_

- [x] 4. データベース層とメタデータ管理の作成




  - ドキュメントと検索履歴用のSQLiteデータベーススキーマを実装
  - データベース接続とマイグレーションユーティリティを作成
  - ドキュメントメタデータのCRUD操作を実装
  - パフォーマンス最適化のためのデータベースインデックスを作成
  - データベース操作のユニットテストを作成
  - _要件: 5.2, 6.4, 7.4_

- [x] 5. Whoosh全文検索エンジンの実装




  - Whooshスキーマ定義を持つIndexManagerクラスを作成
  - 適切なフィールドマッピングでドキュメントインデックスを実装
  - ランキングとスニペット生成付きの全文検索を実装
  - 増分インデックス更新機能を作成
  - インデックス再構築と最適化メソッドを実装
  - インデックスと検索操作のユニットテストを作成
  - _要件: 1.1, 1.2, 1.3, 1.4, 1.5_

- [x] 6. sentence-transformersを使用したセマンティック検索の実装




  - モデル読み込みとキャッシュ機能を持つEmbeddingManagerクラスを作成
  - all-MiniLM-L6-v2モデルを使用したドキュメント埋め込み生成を実装
  - pickleを使用した埋め込みストレージと取得システムを作成
  - コサイン類似度を使用したセマンティック類似度検索を実装
  - 埋め込みキャッシュ管理と永続化を追加
  - 埋め込み生成と類似度検索のユニットテストを作成
  - _要件: 2.1, 2.2, 2.3, 2.4, 2.5_

- [ ] 7. ハイブリッド検索マネージャーの作成
  - 全文検索とセマンティック検索を組み合わせるSearchManagerクラスを実装
  - 検索結果のランキングとマージアルゴリズムを作成
  - 検索タイプ選択と重み付けメカニズムを実装
  - インデックス化されたコンテンツに基づく検索提案機能を追加
  - スニペットとハイライト付きの検索結果フォーマットを作成
  - ハイブリッド検索機能のユニットテストを作成
  - _要件: 1.3, 2.3, 6.4_

- [ ] 8. ファイルシステム監視と増分更新の実装
  - ファイルシステム監視用のwatchdogライブラリを使用したFileWatcherクラスを作成
  - ファイル変更検出（作成、変更、削除）を実装
  - テキストインデックスと埋め込みの両方を更新する増分インデックスワークフローを作成
  - 不要な再処理を避けるためのファイルハッシュベース変更検出を実装
  - ファイル更新用のバックグラウンド処理キューを追加
  - ファイル監視と増分更新のユニットテストを作成
  - _要件: 1.2, 6.4_

- [ ] 9. メインアプリケーションウィンドウとレイアウトの作成
  - PySide6の3ペインレイアウトを持つMainWindowクラスを実装
  - ファイル操作と設定を含むメニューバーを作成
  - 進捗インジケーターとシステムステータス付きのステータスバーを実装
  - キーボードショートカットとアクセシビリティ機能を追加
  - アプリケーションアイコンと基本スタイリングを作成
  - メインウィンドウ機能の統合テストを作成
  - _要件: 4.1, 4.2_

- [ ] 10. フォルダツリーナビゲーションウィジェットの実装
  - QTreeWidgetを拡張したFolderTreeWidgetクラスを作成
  - フォルダ構造の読み込みと表示を実装
  - フォルダ選択と展開機能を追加
  - フォルダ操作用のコンテキストメニューを作成
  - ツリー内でのフォルダフィルタリングと検索を実装
  - フォルダツリー操作のユニットテストを作成
  - _要件: 4.2, 4.3_

- [ ] 11. 検索結果表示ウィジェットの作成
  - QListWidgetを拡張したSearchResultsWidgetクラスを実装
  - タイトル、スニペット、スコア表示付きのカスタム結果アイテムウィジェットを作成
  - 結果のソートとフィルタリングオプションを実装
  - 結果選択とプレビュー機能を追加
  - 大きな結果セット用のページネーションを作成
  - 検索結果表示のユニットテストを作成
  - _要件: 4.3, 4.6_

- [ ] 12. ドキュメントプレビューウィジェットの実装
  - QTextEditを拡張したPreviewWidgetクラスを作成
  - シンタックスハイライト付きのドキュメントコンテンツ表示を実装
  - プレビューテキストでの検索語ハイライトを追加
  - 大きなファイル用のドキュメント要約生成を作成
  - ズームとテキストフォーマットコントロールを実装
  - プレビュー機能のユニットテストを作成
  - _要件: 4.4, 4.5_

- [ ] 13. 検索インターフェースとクエリ処理の作成
  - オートコンプリート付きの検索入力ウィジェットを実装
  - 検索タイプ選択（全文、セマンティック、ハイブリッド）を作成
  - 高度な検索オプションとフィルターを追加
  - 検索履歴と保存された検索を実装
  - 検索進捗インジケーターとキャンセル機能を作成
  - 完全な検索ワークフローの統合テストを作成
  - _要件: 1.3, 2.3, 4.6, 6.4_

- [ ] 14. アプリケーション設定と構成の実装
  - ユーザー設定用の構成管理システムを作成
  - 検索パラメーターとUIオプション用の設定ダイアログを実装
  - インデックス化されたディレクトリのフォルダ管理を追加
  - データストレージ場所の構成を作成
  - ログ構成とレベル選択を実装
  - 構成管理のユニットテストを作成
  - _要件: 5.1, 5.2, 5.3, 7.5_

- [ ] 15. 包括的エラーハンドリングとログの追加
  - ユーザーフレンドリーなメッセージ付きのアプリケーション全体の例外処理を実装
  - 異なるレベルを持つ包括的ログシステムを作成
  - 一般的な障害シナリオのエラー回復メカニズムを追加
  - コンポーネントが失敗した時の優雅な劣化を実装
  - エラー報告と診断情報収集を作成
  - エラーハンドリングシナリオのユニットテストを作成
  - _要件: 3.6, 5.5, 6.6, 7.6_

- [ ] 16. パフォーマンス最適化とキャッシュの実装
  - 頻繁にアクセスされる検索の結果キャッシュを追加
  - 大規模ドキュメントコレクション用のメモリ管理を実装
  - ノンブロッキング操作用のバックグラウンド処理を作成
  - 長時間実行される操作の進捗追跡を追加
  - データベースクエリ最適化とコネクションプーリングを実装
  - 5秒検索要件を検証するパフォーマンステストを作成
  - _要件: 6.1, 6.2, 6.3, 6.4_

- [ ] 17. 包括的テストスイートの作成
  - 高いカバレッジを持つすべてのコアコンポーネントのユニットテストを作成
  - エンドツーエンドワークフローの統合テストを作成
  - 現実的なドキュメントコレクションでのパフォーマンステストを実装
  - QTestフレームワークを使用したGUIテストを追加
  - 様々なドキュメントタイプのテストデータジェネレーターを作成
  - 継続的テストとカバレッジレポートを設定
  - _要件: 6.1, 6.2, 6.3, 6.4, 6.5_

- [ ] 18. Windows展開用アプリケーションパッケージ化
  - PyInstallerまたは類似ツールを使用したアプリケーションパッケージ化スクリプトを作成
  - 適切な依存関係を持つWindowsインストーラーを生成
  - アプリケーションショートカットとファイル関連付けを作成
  - アンインストーラーと更新メカニズムを追加
  - クリーンなWindows 10/11システムでの展開テストを実行
  - ユーザードキュメントとインストールガイドを作成
  - _要件: 7.1, 6.3_