# デバッグルール

## 基本方針

1. **動作を優先してコードを簡略化しない**
   - 一時的な回避策として機能を削除・簡略化することは避ける
   - 設計意図とアーキテクチャを維持しながら問題を解決する

2. **根本原因の特定**
   - 症状だけでなく、問題の根本原因を探る
   - ログ、エラーメッセージ、スタックトレースを詳細に分析する
   - 関連するコンポーネント間の相互作用を理解する

3. **設計意図の尊重**
   - 既存のアーキテクチャパターンを理解し、それに沿った修正を行う
   - 非同期処理、エラーハンドリング、リソース管理などの設計意図を維持する
   - 将来の拡張性を損なわない修正を心がける

## 具体的なガイドライン

### スレッド管理
- QThreadを使用している場合は適切なライフサイクル管理を実装する
- finished シグナルと deleteLater() を使用してリソースリークを防ぐ
- 親オブジェクトとの関係を明確にし、適切なクリーンアップを保証する

### エラーハンドリング
- 例外の根本原因を特定してから修正する
- try-catch で隠蔽するのではなく、適切な処理を実装する
- ユーザーに分かりやすいエラーメッセージを提供する

### リソース管理
- メモリリーク、ファイルハンドルリーク、スレッドリークを防ぐ
- RAII パターンを活用してリソースの自動管理を実装する
- closeEvent や destructor で適切なクリーンアップを行う

## 修正プロセス

1. **問題の再現と分析**
   - 問題を確実に再現できる手順を確立する
   - ログとデバッグ情報を収集する
   - 関連するコードパスを特定する

2. **根本原因の特定**
   - 症状の背後にある真の原因を探る
   - 設計上の問題か実装上の問題かを判断する
   - 他のコンポーネントへの影響を評価する

3. **修正の設計**
   - 既存のアーキテクチャに沿った修正方法を検討する
   - 最小限の変更で最大の効果を得られる方法を選択する
   - 副作用や回帰の可能性を評価する

4. **実装とテスト**
   - 修正を実装し、問題が解決されることを確認する
   - 関連する機能に影響がないことをテストする
   - 必要に応じてテストケースを追加する