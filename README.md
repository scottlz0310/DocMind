# DocMind

DocMindは、ローカルPC上に保存された様々なドキュメント形式（PDF、Word、Excel、Markdown、テキストファイル）に対する包括的な検索機能を持つローカルAI搭載デスクトップアプリケーションです。従来の全文検索とローカルAIモデルを使用したセマンティック検索を組み合わせ、外部API依存なしに完全なオフライン機能を保証します。

このPoC版は、UIの美観よりも検索精度とローカルパフォーマンスを優先し、将来のAPIベースAIサービスをサポートする拡張性を考慮したアーキテクチャで設計されています。

## 主要機能

- **完全オフライン動作**: 外部API依存なし、すべての処理がローカルで実行
- **ハイブリッド検索**: Whoosh全文検索とsentence-transformersセマンティック検索の組み合わせ
- **マルチフォーマット対応**: PDF、Word、Excel、Markdown、テキストファイルの処理
- **リアルタイムインデックス**: 増分ファイルシステム監視とインデックス更新
- **3ペインUI**: フォルダツリー、検索結果、ドキュメントプレビューインターフェース

## 対象ユーザー

完全なプライバシーとオフライン機能を維持しながら、大量のローカルドキュメントコレクションを検索する必要がある開発者、研究者、ナレッジワーカー。

## 現在のステータス

これはPoC（概念実証）実装であり、UIの美観よりも検索精度とローカルパフォーマンスを優先しています。アーキテクチャは、完全なローカル機能を維持しながら、将来のAPIベースのAIサービスをサポートする拡張性を考慮して設計されています。

## パフォーマンス目標

- 最大50,000ドキュメントを5秒以内で検索
- Windows 10/11での10秒以内のアプリケーション起動
- バックグラウンド処理中のレスポンシブUI

## インストール

### 開発環境でのインストール

1. リポジトリをクローン
2. 仮想環境を作成: `python -m venv venv`
3. 仮想環境をアクティベート: `venv\Scripts\activate` (Windows)
4. 依存関係をインストール: `pip install -r requirements.txt`
5. アプリケーションを実行: `python main.py`

### Windows向けバイナリインストール

1. [リリースページ](https://github.com/docmind/docmind/releases)から最新のインストーラーをダウンロード
2. `DocMind_Setup_v1.0.0.exe` を右クリックして「管理者として実行」
3. インストールウィザードに従ってインストール
4. スタートメニューまたはデスクトップショートカットからDocMindを起動

## 使用方法

1. DocMindを起動
2. フォルダツリーを使用してインデックス対象フォルダを選択
3. 初回インデックス作成の完了を待機
4. 検索ボックスを使用してドキュメントを検索
5. 検索タイプを選択（全文検索/セマンティック検索/ハイブリッド）
6. 結果を確認し、ドキュメントをプレビュー

## アーキテクチャ

アプリケーションは、データアクセス、ビジネスロジック、プレゼンテーション層間の明確な分離を持つレイヤードアーキテクチャに従います：

- **GUIレイヤー**: PySide6ベースの3ペインインターフェース
- **ビジネスロジック**: 検索、インデックス、埋め込み、ファイル処理コンポーネント
- **データレイヤー**: メタデータ用SQLite、埋め込み用pickle、テキストインデックス用Whoosh

## 技術スタック

- **言語**: Python 3.11+
- **GUIフレームワーク**: クロスプラットフォームデスクトップインターフェース用PySide6
- **検索エンジン**: 全文検索インデックス用Whoosh
- **AI/ML**: セマンティック検索用sentence-transformers（all-MiniLM-L6-v2モデル）
- **データベース**: メタデータストレージ用SQLite
- **ファイル処理ライブラリ**:
  - PDFテキスト抽出用PyMuPDF
  - Wordドキュメント処理用python-docx
  - Excelファイル処理用openpyxl

## ビルドとデプロイメント

### 開発者向けビルド手順

1. 開発環境をセットアップ
2. ビルドスクリプトを実行: `build_scripts\build_all.bat`
3. 生成されたインストーラーをテスト

### 自動ビルドプロセス

```bash
# 完全ビルドプロセス
cd build_scripts
python build_windows.py

# デプロイメントテスト
python test_deployment.py installer/DocMind_Setup_v1.0.0.exe
```

### システム要件

- **OS**: Windows 10 (64-bit) 以降
- **CPU**: Intel Core i3以上推奨
- **メモリ**: 4GB以上（8GB推奨）
- **ストレージ**: 2GB以上の空き容量

## トラブルシューティング

### よくある問題

1. **起動しない場合**
   - Windows Defenderの除外設定を確認
   - 管理者権限で実行
   - イベントビューアーでエラーログを確認

2. **検索結果が表示されない場合**
   - インデックス作成の完了を確認
   - 検索対象フォルダの設定を確認
   - ファイル形式の対応状況を確認

3. **パフォーマンスが遅い場合**
   - 利用可能メモリを確認
   - 検索対象ファイル数を制限
   - キャッシュ設定を調整

## 貢献

プロジェクトへの貢献を歓迎します：

1. Issueを作成して問題を報告
2. Pull Requestで改善を提案
3. ドキュメントの改善
4. テストケースの追加

## ライセンス

MIT License - 詳細はLICENSEファイルを参照してください。

## サポート

- **ドキュメント**: `installer/docs/` ディレクトリ内のマニュアルを参照
- **Issue報告**: GitHubのIssueページで問題を報告
- **ディスカッション**: GitHubのDiscussionsで質問や提案を投稿
