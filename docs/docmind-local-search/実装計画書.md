# 実装計画書

- [ ] 1. プロジェクト構造とコア依存関係の設定
  - モデル、サービス、GUIコンポーネント、データストレージ用のディレクトリ構造を作成
  - 必要な依存関係（PySide6、Whoosh、sentence-transformers、PyMuPDF、python-docx、openpyxl）を含むrequirements.txtを設定
  - メインアプリケーションのエントリーポイントと基本的な設定管理を作成
  - _要件: 7.2, 7.3_

- [ ] 2. コアデータモデルと例外の実装
  - 必要なフィールドとバリデーションを含むDocumentデータクラスを作成
  - スコアリングとスニペット情報を含むSearchResultデータクラスを作成
  - SearchType列挙型とその他のサポートデータ構造を実装
  - エラーハンドリング用のカスタム例外階層を作成
  - _要件: 6.6, 7.6_

- [ ] 3. ドキュメント処理システムの実装
  - 各ファイル形式用のテキスト抽出メソッドを含むDocumentProcessorクラスを作成
  - エラーハンドリングを含むPyMuPDFを使用したPDFテキスト抽出を実装
  - python-docxを使用したWordドキュメント処理を実装
  - すべてのシートとセルのopenpyxlを使用したExcelテキスト抽出を実装
  - エンコーディング検出を含むMarkdownとテキストファイル処理を実装
  - 各ドキュメントプロセッサーメソッドのユニットテストを作成
  - _要件: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6_

- [ ] 4. データベースレイヤーとメタデータ管理の作成
  - ドキュメントと検索履歴用のSQLiteデータベーススキーマを実装
  - データベース接続とマイグレーション用ユーティリティを作成
  - ドキュメントメタデータCRUD操作を実装
  - パフォーマンス最適化用のデータベースインデックスを作成
  - データベース操作のユニットテストを作成
  - _要件: 5.2, 6.4, 7.4_

- [ ] 5. Whooshフルテキスト検索エンジンの実装
  - Whooshスキーマ定義を含むIndexManagerクラスを作成
  - 適切なフィールドマッピングを含むドキュメントインデックス作成を実装
  - ランキングとスニペット生成を含むフルテキスト検索を実装
  - インクリメンタルインデックス更新機能を作成
  - インデックス再構築と最適化メソッドを実装
  - インデックス作成と検索操作のユニットテストを作成
  - _要件: 1.1, 1.2, 1.3, 1.4, 1.5_

- [ ] 6. sentence-transformersを使用したセマンティック検索の実装
  - モデル読み込みとキャッシュを含むEmbeddingManagerクラスを作成
  - all-MiniLM-L6-v2モデルを使用したドキュメント埋め込み生成を実装
  - pickleを使用した埋め込みストレージと取得システムを作成
  - コサイン類似度を使用したセマンティック類似性検索を実装
  - 埋め込みキャッシュ管理と永続化を追加
  - 埋め込み生成と類似性検索のユニットテストを作成
  - _要件: 2.1, 2.2, 2.3, 2.4, 2.5_

- [ ] 7. ハイブリッド検索マネージャーの作成
  - フルテキストとセマンティック検索を組み合わせるSearchManagerクラスを実装
  - 検索結果ランキングとマージアルゴリズムを作成
  - 検索タイプ選択と重み付けメカニズムを実装
  - インデックスされたコンテンツに基づく検索提案機能を追加
  - スニペットとハイライトを含む検索結果フォーマットを作成
  - ハイブリッド検索機能のユニットテストを作成
  - _要件: 1.3, 2.3, 6.4_

- [ ] 8. ファイルシステム監視とインクリメンタル更新の実装
  - ファイルシステム監視用のwatchdogライブラリを使用したFileWatcherクラスを作成
  - ファイル変更検出（作成、変更、削除）を実装
  - テキストインデックスと埋め込みの両方を更新するインクリメンタルインデックス作成ワークフローを作成
  - 不要な再処理を避けるためのファイルハッシュベース変更検出を実装
  - ファイル更新用のバックグラウンド処理キューを追加
  - ファイル監視とインクリメンタル更新のユニットテストを作成
  - _要件: 1.2, 6.4_

- [ ] 9. メインアプリケーションウィンドウとレイアウトの作成
  - PySide6三パネルレイアウトを含むMainWindowクラスを実装
  - ファイル操作と設定を含むメニューバーを実装
  - プログレスインジケーターとシステムステータスを含むステータスバーを実装
  - キーボードショートカットとアクセシビリティ機能を追加
  - アプリケーションアイコンと基本的なスタイリングを作成
  - メインウィンドウ機能の統合テストを作成
  - _要件: 4.1, 4.2_

- [ ] 10. フォルダツリーナビゲーションウィジェットの実装
  - QTreeWidgetを拡張したFolderTreeWidgetクラスを作成
  - フォルダ構造の読み込みと表示を実装
  - フォルダ選択と展開機能を追加
  - フォルダ操作用のコンテキストメニューを作成
  - ツリー内のフォルダフィルタリングと検索を実装
  - フォルダツリー操作のユニットテストを作成
  - _要件: 4.2, 4.3_

- [ ] 11. 検索結果表示ウィジェットの作成
  - QListWidgetを拡張したSearchResultsWidgetクラスを実装
  - タイトル、スニペット、スコア表示を含むカスタム結果アイテムウィジェットを作成
  - 結果ソートとフィルタリングオプションを実装
  - 結果選択とプレビュー機能を追加
  - 大規模結果セット用のページネーションを作成
  - 検索結果表示のユニットテストを作成
  - _要件: 4.3, 4.6_

- [ ] 12. ドキュメントプレビューウィジェットの実装
  - QTextEditを拡張したPreviewWidgetクラスを作成
  - シンタックスハイライトを含むドキュメントコンテンツ表示を実装
  - プレビューテキスト内の検索語ハイライトを追加
  - 大規模ファイル用のドキュメント要約生成を作成
  - ズームとテキストフォーマット制御を実装
  - プレビュー機能のユニットテストを作成
  - _要件: 4.4, 4.5_

- [ ] 13. 検索インターフェースとクエリ処理の作成
  - オートコンプリートを含む検索入力ウィジェットを実装
  - 検索タイプ選択（フルテキスト、セマンティック、ハイブリッド）を作成
  - 高度な検索オプションとフィルターを追加
  - 検索履歴と保存された検索を実装
  - 検索プログレスインジケーターとキャンセルを作成
  - 完全な検索ワークフローの統合テストを作成
  - _要件: 1.3, 2.3, 4.6, 6.4_

- [ ] 14. アプリケーション設定と設定の実装
  - ユーザー設定用の設定管理システムを作成
  - 検索パラメーターとUIオプション用の設定ダイアログを実装
  - インデックス化されたディレクトリ用のフォルダ管理を追加
  - データストレージ場所設定を作成
  - ログ設定とレベル選択を実装
  - 設定管理のユニットテストを作成
  - _要件: 5.1, 5.2, 5.3, 7.5_

- [ ] 15. 包括的なエラーハンドリングとログの追加
  - ユーザーフレンドリーなメッセージを含むアプリケーション全体の例外処理を実装
  - 異なるレベルを含む包括的なログシステムを作成
  - 一般的な失敗シナリオ用のエラー回復メカニズムを追加
  - コンポーネントが失敗した場合の適切な劣化を実装
  - エラー報告と診断情報収集を作成
  - エラーハンドリングシナリオのユニットテストを作成
  - _要件: 3.6, 5.5, 6.6, 7.6_

- [ ] 16. パフォーマンス最適化とキャッシュの実装
  - 頻繁にアクセスされる検索用の結果キャッシュを追加
  - 大規模ドキュメントコレクション用のメモリ管理を実装
  - 非ブロッキング操作用のバックグラウンド処理を作成
  - 長時間実行操作用のプログレストラッキングを追加
  - データベースクエリ最適化とコネクションプーリングを実装
  - 5秒検索要件を検証するパフォーマンステストを作成
  - _要件: 6.1, 6.2, 6.3, 6.4_

- [ ] 17. 包括的なテストスイートの作成
  - 高カバレッジを持つすべてのコアコンポーネントのユニットテストを作成
  - エンドツーエンドワークフロー用の統合テストを作成
  - 現実的なドキュメントコレクションを使用したパフォーマンステストを実装
  - QTestフレームワークを使用したGUIテストを追加
  - 様々なドキュメントタイプ用のテストデータジェネレーターを作成
  - 継続的テストとカバレッジレポートを設定
  - _要件: 6.1, 6.2, 6.3, 6.4, 6.5_

- [ ] 18. Windows展開用のアプリケーションパッケージング
  - PyInstallerまたは類似ツールを使用したアプリケーションパッケージングスクリプトを作成
  - 適切な依存関係を含むWindowsインストーラーを生成
  - アプリケーションショートカットとファイル関連付けを作成
  - アンインストーラーと更新メカニズムを追加
  - クリーンなWindows 10/11システムでの展開をテスト
  - ユーザードキュメントとインストールガイドを作成
  - _要件: 7.1, 6.3_

