# DocMind トラブルシューティングガイド

## 目次

1. [一般的な問題](#一般的な問題)
2. [インストール関連](#インストール関連)
3. [検索機能の問題](#検索機能の問題)
4. [インデックス関連](#インデックス関連)
5. [パフォーマンス問題](#パフォーマンス問題)
6. [エラーメッセージ一覧](#エラーメッセージ一覧)
7. [ログファイルの確認方法](#ログファイルの確認方法)
8. [サポート情報の収集](#サポート情報の収集)

## 一般的な問題

### アプリケーションが起動しない

#### 症状
- DocMindのアイコンをクリックしても何も起こらない
- エラーメッセージが表示される
- 起動途中でクラッシュする

#### 原因と対処法

**1. 管理者権限の不足**
```
対処法:
1. DocMindのショートカットを右クリック
2. 「管理者として実行」を選択
3. UACダイアログで「はい」をクリック
```

**2. ウイルス対策ソフトによるブロック**
```
対処法:
1. ウイルス対策ソフトの設定を開く
2. 除外設定にDocMindのインストールフォルダを追加
3. リアルタイム保護の例外にDocMind.exeを追加
```

**3. システム要件不足**
```
確認項目:
- OS: Windows 10 (64-bit) 以降
- メモリ: 4GB以上
- ディスク容量: 2GB以上の空き
- .NET Framework: 最新版
```

**4. 破損したインストール**
```
対処法:
1. コントロールパネル → プログラムと機能
2. DocMindを選択して「アンインストール」
3. 最新のインストーラーを再ダウンロード
4. 管理者として再インストール
```

### 画面が正しく表示されない

#### 症状
- ウィンドウが真っ白または真っ黒
- UI要素が重なって表示される
- 文字が読めない

#### 対処法

**1. ディスプレイ設定の確認**
```
手順:
1. Windowsの設定 → システム → ディスプレイ
2. 拡大縮小を100%に設定
3. DocMindを再起動
```

**2. グラフィックドライバーの更新**
```
手順:
1. デバイスマネージャーを開く
2. ディスプレイアダプターを展開
3. グラフィックカードを右クリック → ドライバーの更新
```

**3. 設定ファイルのリセット**
```
手順:
1. DocMindを終了
2. %APPDATA%\DocMind\config.json を削除
3. DocMindを再起動(デフォルト設定で起動)
```

## インストール関連

### インストールが失敗する

#### エラー: 「インストーラーが破損しています」

**対処法:**
1. インストーラーを再ダウンロード
2. ダウンロード完了後、ファイルのハッシュ値を確認
3. 一時的にウイルス対策ソフトを無効化してインストール

#### エラー: 「管理者権限が必要です」

**対処法:**
1. インストーラーを右クリック
2. 「管理者として実行」を選択
3. UACダイアログで「はい」をクリック

#### エラー: 「ディスク容量が不足しています」

**対処法:**
1. ディスククリーンアップを実行
2. 不要なファイルを削除
3. 別のドライブにインストール

### アンインストールができない

#### 症状
- コントロールパネルにDocMindが表示されない
- アンインストールが途中で止まる

#### 対処法

**1. 手動アンインストール**
```
手順:
1. DocMindのプロセスを全て終了
2. インストールフォルダを削除
3. レジストリエディタでDocMind関連エントリを削除
4. %APPDATA%\DocMind フォルダを削除
```

**2. アンインストールツールの使用**
```
推奨ツール:
- Revo Uninstaller
- IObit Uninstaller
- Geek Uninstaller
```

## 検索機能の問題

### 検索結果が表示されない

#### 症状
- 検索を実行しても結果が0件
- 明らかに存在するファイルが見つからない

#### 原因と対処法

**1. インデックス未作成**
```
確認方法:
1. ステータスバーでインデックス状況を確認
2. 「インデックス作成中」と表示されている場合は完了まで待機

対処法:
1. メニュー → 検索 → インデックス再構築
2. 完了まで待機(大量ファイルの場合は時間がかかる)
```

**2. フォルダが選択されていない**
```
対処法:
1. 左ペインのフォルダツリーでフォルダを選択
2. 選択したフォルダにチェックマークが付いていることを確認
```

**3. ファイル形式が対応していない**
```
対応形式:
- PDF (.pdf)
- Word (.docx, .doc)
- Excel (.xlsx, .xls)
- Markdown (.md, .markdown)
- テキスト (.txt, .log, .csv)

対処法:
- 対応していない形式のファイルはテキスト形式に変換
```

**4. 検索クエリの問題**
```
確認項目:
- 最小文字数(デフォルト2文字)以上で検索
- 特殊文字が含まれていないか確認
- 日本語と英語の混在に注意

改善方法:
- より具体的なキーワードを使用
- フレーズ検索("完全一致")を試す
- セマンティック検索を使用
```

### 検索結果が不正確

#### 症状
- 関係ないファイルが検索結果に含まれる
- 期待したファイルが上位に表示されない

#### 対処法

**1. 検索タイプの調整**
```
推奨設定:
- 正確な検索: 全文検索
- 概念的な検索: セマンティック検索
- バランス重視: ハイブリッド検索(デフォルト)
```

**2. フィルタの活用**
```
利用可能フィルタ:
- ファイル形式
- 更新日時
- ファイルサイズ
- フォルダ指定
```

**3. 検索クエリの改善**
```
効果的な検索方法:
- 具体的なキーワード: 「会議」→「四半期レビュー会議」
- 複数キーワード: 「予算 2024 承認」
- 除外キーワード: 「レポート -草案」
```

### 検索が遅い

#### 症状
- 検索実行から結果表示まで10秒以上かかる
- 検索中にアプリケーションが応答しない

#### 原因と対処法

**1. 大量のファイル**
```
対処法:
1. フォルダを分割してインデックス
2. 不要なファイルを除外設定に追加
3. 検索対象を特定のフォルダに限定
```

**2. システムリソース不足**
```
対処法:
1. 他のアプリケーションを終了
2. システムメモリを増設
3. SSDを使用(HDDからの移行)
```

**3. インデックスの断片化**
```
対処法:
1. メニュー → 検索 → インデックス再構築
2. 定期的な再構築(週1回程度)
```

## インデックス関連

### インデックス作成が失敗する

#### エラー: 「ファイルにアクセスできません」

**対処法:**
```
1. ファイルの読み取り権限を確認
2. ファイルが他のアプリケーションで開かれていないか確認
3. ネットワークドライブの場合は接続状況を確認
4. 管理者権限でDocMindを実行
```

#### エラー: 「ディスク容量が不足しています」

**対処法:**
```
1. インデックス用に十分な容量を確保(元ファイルの10-20%程度)
2. 一時ファイルをクリーンアップ
3. データディレクトリを容量の大きいドライブに移動
```

#### エラー: 「メモリ不足です」

**対処法:**
```
1. 他のアプリケーションを終了
2. 設定でメモリ使用量制限を下げる
3. より小さなフォルダ単位でインデックス作成
4. システムメモリの増設を検討
```

### インデックス更新が反映されない

#### 症状
- 新しいファイルが検索結果に表示されない
- 削除したファイルが検索結果に残る
- 更新したファイルの内容が古いまま

#### 対処法

**1. 自動監視の確認**
```
確認手順:
1. 設定 → システム → ファイル監視
2. 「自動監視を有効にする」がチェックされているか確認
3. 無効の場合は有効にして再起動
```

**2. 手動更新の実行**
```
手順:
1. 対象フォルダを右クリック
2. 「インデックスを更新」を選択
3. 更新完了まで待機
```

**3. 完全再構築**
```
手順:
1. メニュー → 検索 → インデックス再構築
2. 確認ダイアログで「はい」をクリック
3. 完了まで待機(時間がかかる場合があります)
```

## パフォーマンス問題

### 起動が遅い

#### 症状
- アプリケーション起動に30秒以上かかる
- スプラッシュ画面で止まる

#### 対処法

**1. スタートアップ最適化**
```
手順:
1. タスクマネージャー → スタートアップタブ
2. 不要なスタートアッププログラムを無効化
3. システムを再起動
```

**2. インデックスサイズの確認**
```
確認方法:
1. データディレクトリのサイズを確認
2. 1GB以上の場合は分割を検討
3. 古いインデックスファイルを削除
```

**3. ディスクの最適化**
```
手順:
1. ディスクデフラグツールを実行
2. SSDの場合はTRIMコマンドを実行
3. ディスククリーンアップを実行
```

### メモリ使用量が多い

#### 症状
- DocMindが1GB以上のメモリを使用
- システム全体が重くなる

#### 対処法

**1. メモリ使用量制限の設定**
```
手順:
1. 設定 → システム → パフォーマンス
2. 最大メモリ使用量を調整(システムメモリの50%以下)
3. 設定を保存して再起動
```

**2. キャッシュサイズの調整**
```
推奨設定:
- 4GBシステム: 200MB
- 8GBシステム: 500MB
- 16GB以上: 1GB
```

**3. 不要なファイルの除外**
```
除外推奨:
- 一時ファイル (.tmp, .temp)
- システムファイル
- バックアップファイル (.bak)
- ログファイル (.log) ※必要に応じて
```

## エラーメッセージ一覧

### 起動時エラー

| エラーメッセージ | 原因 | 対処法 |
|---|---|---|
| 「アプリケーションを開始できませんでした」 | .NET Framework不足 | 最新の.NET Frameworkをインストール |
| 「設定ファイルが破損しています」 | config.json破損 | 設定ファイルを削除して再起動 |
| 「データディレクトリにアクセスできません」 | 権限不足 | 管理者権限で実行 |

### 検索時エラー

| エラーメッセージ | 原因 | 対処法 |
|---|---|---|
| 「インデックスが見つかりません」 | インデックス未作成 | インデックス再構築を実行 |
| 「検索がタイムアウトしました」 | 処理時間超過 | 検索クエリを具体化、またはフィルタを使用 |
| 「フォルダが選択されていません」 | フォルダ未選択 | 左ペインでフォルダを選択 |

### インデックス作成エラー

| エラーメッセージ | 原因 | 対処法 |
|---|---|---|
| 「ファイルを読み取れません」 | アクセス権限不足 | ファイルの読み取り権限を確認 |
| 「ディスク容量が不足しています」 | 容量不足 | 不要ファイルを削除 |
| 「最大同時実行数に達しています」 | 処理中の重複実行 | 現在の処理完了まで待機 |

## ログファイルの確認方法

### ログファイルの場所

```
メインログ: docmind_data/logs/docmind.log
エラーログ: docmind_data/logs/error.log
インデックスログ: docmind_data/logs/indexing.log
```

### ログレベルの設定

```
ERROR: エラーのみ記録
WARNING: 警告とエラーを記録
INFO: 一般情報、警告、エラーを記録(デフォルト)
DEBUG: 詳細なデバッグ情報を記録
```

### ログの確認方法

**1. ログビューアーの使用**
```
手順:
1. メニュー → ヘルプ → ログを表示
2. ログレベルでフィルタリング
3. 時間範囲を指定して検索
```

**2. テキストエディタで直接確認**
```
推奨エディタ:
- Notepad++
- Visual Studio Code
- メモ帳(小さなファイルの場合)
```

### 重要なログエントリ

```
[ERROR] - 処理を停止させるエラー
[WARNING] - 注意が必要な状況
[INFO] - 一般的な処理状況
[DEBUG] - 詳細な処理情報
```

## サポート情報の収集

### 問題報告時に必要な情報

**1. システム情報**
```
- OS バージョン(Windows 10/11)
- メモリ容量
- CPU情報
- ディスク容量と使用量
- DocMind バージョン
```

**2. エラー情報**
```
- 正確なエラーメッセージ
- エラー発生時刻
- 再現手順
- スクリーンショット
```

**3. ログファイル**
```
- 直近のエラーログ
- 問題発生時のメインログ
- インデックス作成ログ(該当する場合)
```

### システム情報の取得方法

**1. DocMind内から取得**
```
手順:
1. メニュー → ヘルプ → システム情報
2. 「クリップボードにコピー」をクリック
3. 問題報告時に貼り付け
```

**2. Windowsシステム情報**
```
手順:
1. Win + R キーを押す
2. 「msinfo32」と入力してEnter
3. システムの概要を確認
```

### サポート窓口

**GitHub Issues**
- URL: https://github.com/docmind/docmind/issues
- 新しいIssueを作成して問題を報告
- テンプレートに従って必要情報を記入

**ディスカッション**
- URL: https://github.com/docmind/docmind/discussions
- 一般的な質問や使用方法の相談

### 緊急時の対処

**1. アプリケーションが応答しない**
```
手順:
1. Ctrl + Alt + Delete でタスクマネージャーを開く
2. DocMindプロセスを選択
3. 「タスクの終了」をクリック
4. 安全モードで再起動
```

**2. データが破損した場合**
```
復旧手順:
1. DocMindを終了
2. データディレクトリをバックアップ
3. 設定ファイルを削除
4. インデックス再構築を実行
```

**3. 完全リセット**
```
手順:
1. DocMindをアンインストール
2. %APPDATA%\DocMind フォルダを削除
3. 最新版を再インストール
4. 初期設定から開始
```